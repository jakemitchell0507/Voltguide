<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SparkysMate</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  background: #0f172a;
  color: white;
  text-align: center;
}
header { background:#020617; padding:15px; }

button {
  display:block; margin:10px auto; padding:12px;
  width:80%; max-width:320px;
  border:none; border-radius:10px;
  background:#2563eb; color:white; font-size:16px;
  cursor:pointer;
}

input, select {
  width:80%; max-width:320px;
  padding:10px; margin:8px auto; display:block;
  border-radius:8px; border:none;
}

.screen { display:none; }
.screen.active { display:block; }

.result { font-weight:bold; margin-top:10px; }
.small { font-size:13px; opacity:0.8; }
</style>
</head>

<body>

<header><h1>⚡ SparkysMate</h1></header>

<main>

<!-- HOME -->
<section id="home" class="screen active">
<button onclick="show('voltage')">Voltage Drop</button>
<button onclick="show('fault')">Distance to Fault</button>
<button onclick="show('zs')">Max Zs Lookup</button>
<button onclick="show('fill')">Conduit Fill</button>
<button onclick="show('bend')">Conduit Bending</button>
<button onclick="show('cable')">Cable Size Calculator</button>
<button onclick="show('history')">Saved Results</button>
</section>

<!-- Voltage Drop -->
<section id="voltage" class="screen">
<h2>Voltage Drop</h2>
<select id="cableSizeVD">
<option value="1.5">1.5 mm²</option>
<option value="2.5">2.5 mm²</option>
<option value="4">4 mm²</option>
<option value="6">6 mm²</option>
<option value="10">10 mm²</option>
</select>
<input id="lengthVD" type="number" placeholder="Length (m)">
<input id="currentVD" type="number" placeholder="Current (A)">
<button onclick="calcVoltage()">Calculate</button>
<p id="voltageResult" class="result"></p>
<button onclick="save('Voltage Drop', voltageResult.textContent)">Save</button>
<button onclick="show('home')">Back</button>
</section>

<!-- Fault -->
<section id="fault" class="screen">
<h2>Distance to Fault</h2>
<input id="faultDrop" type="number" placeholder="Voltage Drop (V)">
<input id="faultRes" type="number" placeholder="Resistance (Ω/m)">
<button onclick="calcFault()">Calculate</button>
<p id="faultResult" class="result"></p>
<button onclick="save('Fault Distance', faultResult.textContent)">Save</button>
<button onclick="show('home')">Back</button>
</section>

<!-- Zs -->
<section id="zs" class="screen">
<h2>Max Zs</h2>
<select id="type">
<option>B</option><option>C</option><option>D</option>
</select>
<select id="rating">
<option>6</option><option>10</option><option>16</option>
<option>20</option><option>32</option><option>40</option>
<option>50</option><option>63</option>
</select>
<button onclick="calcZs()">Lookup</button>
<p id="zsResult" class="result"></p>
<button onclick="save('Max Zs', zsResult.textContent)">Save</button>
<button onclick="show('home')">Back</button>
</section>

<!-- Conduit Fill -->
<section id="fill" class="screen">
<h2>Conduit Fill %</h2>
<input id="wireArea" type="number" placeholder="Area of one conductor">
<input id="numWires" type="number" placeholder="Number of conductors">
<input id="conduitArea" type="number" placeholder="Total conduit area">
<button onclick="calcFill()">Calculate</button>
<p id="fillResult" class="result"></p>
<button onclick="save('Conduit Fill', fillResult.textContent)">Save</button>
<button onclick="show('home')">Back</button>
</section>

<!-- Conduit Bending -->
<section id="bend" class="screen">
<h2>Conduit Bending</h2>
<p class="small">All measurements are in millimetres (mm)</p>

<h3>Offset Bend</h3>
<input id="offset" type="number" placeholder="Offset height (mm)">
<select id="angle">
<option value="5.8">10°</option>
<option value="2.6">22.5°</option>
<option value="2.0">30°</option>
<option value="1.4">45°</option>
<option value="1.2">60°</option>
</select>
<button onclick="calcOffset()">Calculate Offset Distance</button>
<p id="offsetResult" class="result"></p>

<h3>Rolling Offset</h3>
<input id="rise" type="number" placeholder="Height (mm)">
<input id="run" type="number" placeholder="Width (mm)">
<button onclick="calcRoll()">Calculate Rolling Distance</button>
<p id="rollResult" class="result"></p>

<button onclick="show('home')">Back</button>
</section>

<!-- Cable Size -->
<section id="cable" class="screen">
<h2>Cable Size Calculator</h2>
<input id="loadCurrent" type="number" placeholder="Load current (A)">
<input id="loadLength" type="number" placeholder="Cable length (m)">
<button onclick="calcCable()">Recommend Cable</button>
<p id="cableResult" class="result"></p>
<button onclick="save('Cable Size', cableResult.textContent)">Save</button>
<button onclick="show('home')">Back</button>
</section>

<!-- History -->
<section id="history" class="screen">
<h2>Saved Results</h2>
<ul id="list"></ul>
<button onclick="clearAll()">Clear All</button>
<button onclick="show('home')">Back</button>
</section>

</main>

<script>
function show(id){
document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
document.getElementById(id).classList.add('active');
if(id==='history') load();
}

/* Voltage Drop */
function calcVoltage(){
const map={1.5:0.0121,2.5:0.00741,4:0.00461,6:0.00308,10:0.00183};
const v=map[cableSizeVD.value]*lengthVD.value*currentVD.value;
voltageResult.textContent="Voltage Drop: "+v.toFixed(2)+" V";
}

/* Fault */
function calcFault(){
faultResult.textContent="Distance: "+(faultDrop.value/faultRes.value).toFixed(1)+" m";
}

/* Zs */
function calcZs(){
const t={
B:{6:7.67,10:4.6,16:2.87,20:2.3,32:1.44,40:1.15,50:0.92,63:0.73},
C:{6:3.83,10:2.3,16:1.44,20:1.15,32:0.72,40:0.58,50:0.46,63:0.37},
D:{6:1.92,10:1.15,16:0.72,20:0.58,32:0.36,40:0.29,50:0.23,63:0.18}};
zsResult.textContent="Max Zs: "+t[type.value][rating.value]+" Ω";
}

/* Fill */
function calcFill(){
const f=(wireArea.value*numWires.value)/conduitArea.value*100;
fillResult.textContent="Fill: "+f.toFixed(1)+"%"+(f>40?" ⚠️ Over limit":" OK");
}

/* Bending */
function calcOffset(){
offsetResult.textContent="Distance: "+(offset.value*angle.value).toFixed(2)+" mm";
}
function calcRoll(){
rollResult.textContent="Distance: "+Math.sqrt(rise.value**2+run.value**2).toFixed(2)+" mm";
}

/* Cable recommendation — simplified */
function calcCable(){
const cables=[
{size:"1.5 mm²",cap:16,vd:0.0121},
{size:"2.5 mm²",cap:25,vd:0.00741},
{size:"4 mm²",cap:32,vd:0.00461},
{size:"6 mm²",cap:40,vd:0.00308},
{size:"10 mm²",cap:63,vd:0.00183}
];

const I=Number(loadCurrent.value);
const L=Number(loadLength.value);

for(const c of cables){
const drop=c.vd*L*I;
if(I<=c.cap && drop<=11.5){
cableResult.textContent=`Recommended: ${c.size} (Voltage drop ${drop.toFixed(2)} V)`;
return;
}
}
cableResult.textContent="⚠️ Use cable larger than 10 mm²";
}

/* Storage */
function save(t,v){
if(!v) return;
let d=JSON.parse(localStorage.getItem("volt")||"[]");
d.push(t+": "+v);
localStorage.setItem("volt",JSON.stringify(d));
}

function load(){
list.innerHTML="";
(JSON.parse(localStorage.getItem("volt")||"[]")).forEach(i=>{
let li=document.createElement("li");
li.textContent=i;
list.appendChild(li);
});
}

function clearAll(){
localStorage.removeItem("volt");
load();
}
</script>

</body>
</html>
